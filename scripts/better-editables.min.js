function BetterEditable(t){function e(t,e){for(var i=0;i<t.length;++i)if("undefined"!=typeof t[i])return e===!0?"string"==typeof t[i]&&"true"===t[i].toLowerCase()||t[i]===!0?!0:!1:t[i];return void 0}this.$element=t.$element,this.options={},this.options.url=e([this.$element.data("url"),t.url]),this.options.displayFunction=e([t.displayFunction,function(t,e){return $.betterEditableData["default"].displayFunction(t,e)}]),this.options.fieldName=e([this.$element.data("name"),t.fieldName,this.$element.attr("name"),this.$element.attr("id")]),this.options.pk=e([this.$element.data("pk"),t.pk]),this.options.mode=e([this.$element.data("mode"),t.mode]),"popup"!==this.options.mode&&(this.options.mode="inline"),this.options.placement=e([this.$element.data("placement"),t.placement,"right"]),this.options.type=e([this.$element.data("type"),this.$element.attr("type"),t.type]),this.options.typeSettings=t.typeSettings,this.options.ajaxObject=t.ajaxObject,this.options.ajaxParams=t.ajaxParams,this.options.dataSource=t.dataSource,this.options.load=e([t.load,{start:function(t){return $.betterEditableData["default"].load.start(t)},end:function(t,e){return $.betterEditableData["default"].load.end(t,e)}}]),this.options.onAjaxError=e([t.onAjaxError,function(t,e,i,a,n){return $.betterEditableData["default"].onAjaxError(t,e,i,a,n)}]),this.options.onAjaxSuccess=e([t.onAjaxSuccess,function(t,e){return $.betterEditableData["default"].onAjaxSuccess(t,e)}]),this.options.errorHandler=e([t.errorHandler,function(t,e,i){return $.betterEditableData["default"].errorHandler(t,e,i)}]),this.options.submitNoChange=e([this.$element.data("submit-no-change"),t.submitNoChange,!1],!0),this.options.submitOnBlur=e([this.$element.data("submit-on-blur"),t.submitOnBlur,!0],!0),this.options.emptyDisplay=e([this.$element.data("empty-display"),t.emptyDisplay,"n/a"]),this.options.boolDisplay=e([t.boolDisplay,function(t,e){return $.betterEditableData["default"].boolDisplay(t,e)}]),this.options.selectDisplay=e([t.selectDisplay,function(t,e){return $.betterEditableData["default"].selectDisplay(t,e)}]),this.options.textareaDisplay=e([t.textareaDisplay,function(t,e){return $.betterEditableData["default"].textareaDisplay(t,e)}]),this.options.dateDisplay=e([t.dateDisplay,function(t,e){return $.betterEditableData["default"].dateDisplay(t,e)}]),this.options.clearButton=e([this.$element.data("clear-button"),t.clearButton,!0],!0),this.options.buttonsOn=e([this.$element.data("buttons-on"),t.buttonsOn,!0],!0),this.options.inputClass=e([this.$element.data("input-class"),t.inputClass]),this.options.buttonClass=e([this.$element.data("button-class"),t.buttonClass]),this.options.errorClass=e([this.$element.data("error-class"),t.errorClass]),this.options.tabIndex=e([this.$element.data("tab-index"),t.tabIndex]),this.options.tabbingOn=e([this.$element.data("tabbing-on"),t.tabbingOn,!1],!0),this.$element.attr("data-editable",""),this.options.tabbingOn!==!0||"string"!=typeof this.options.tabIndex&&"number"!=typeof this.options.tabIndex||this.$element.attr("data-tab-index",this.options.tabIndex),this.setValue(e([this.$element.data("value"),t.value,this.$element.attr("value"),this.$element.text()])),this.state={},this.resetState(),this.state.popupOpen=!1,this.createInputField(),this.initializeValidators(),this.options.displayFunction(this),t.readOnly===!0?this.toggleReadOnly(!0):this.state.readOnly=!1;var i=this;this.$element.on("click",function(){$.betterEditableData.utils.stopPropagation(event),i.show(),"bool"!=i.options.type||i.isReadOnly()||i.$input.trigger("click")}),this.$element.addClass("editable-ready"),this.$element.trigger("be.init",this)}$.betterEditableData={},$.betterEditableData.version="0.14.10",$.betterEditableData.utils={stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.returnValue=!1},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},getIEVersion:function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(e>-1)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);var i=t.indexOf("Trident/");if(i>-1){var a=t.indexOf("rv:");return parseInt(t.substring(a+3,t.indexOf(".",a)),10)}var n=t.indexOf("Edge/");return n>-1?parseInt(t.substring(n+5,t.indexOf(".",n)),10):0}},$.betterEditableData["default"]={displayFunction:function(t,e){"undefined"==typeof e&&(e=t.value,"select"==t.options.type?e=t.options.selectDisplay(t,e):"textarea"==t.options.type?e=t.options.textareaDisplay(t,e):"bool"==t.options.type?e=t.options.boolDisplay(t,e):"datetimepicker"==t.options.type&&(e=t.options.dateDisplay(t,e))),t.$element.html(e),"undefined"==typeof e||null===e||""===e.toString().trim()?(t.$element.html(t.options.emptyDisplay),t.$element.hasClass("empty")||t.$element.addClass("empty")):t.$element.removeClass("empty")},load:{start:function(t){t.toggleReadOnly(!0),t.$element.text("Submitting...")},end:function(t,e){e.options.displayFunction(e),e.toggleReadOnly(!1)}},onAjaxSuccess:function(t,e){e.options.load.end({data:t,hasError:!1},e)},onAjaxError:function(t,e,i,a,n){var o=e.statusText,s=e.status;("string"!=typeof o||""===o.trim())&&(o=t.statusText),"number"==typeof s||"string"==typeof s&&""!==s.trim()||(s=t.status);var r=s+": "+o;n.options.load.end({data:r,hasError:!1},n),n.options.errorHandler(s+": "+o,n,!0),n.show(),n.setInputValue(n.errorValue)},errorHandler:function(t,e,i){var a=e.$element.attr("id");if(i){var n=!0;if("string"==typeof a&&""!==a){var o=$('[data-valmsg-for="'+a+'"]').first();0==o.length&&(o=$('[data-for="'+a+'"]').first()),o.length>0&&(n=!1,o.text(t).show())}if(n){var o=$("<span></span>").addClass(e.options.errorClass).addClass("editable-error").attr("data-for",a).attr("data-valmsg-for",a).text(t);"bool"!=e.options.type?e.$inputDiv.find(".editable-input-wrapper").append(o):e.$inputDiv.after(o)}}else{var o=$('[data-valmsg-for="'+a+'"]').first();0==o.length&&(o=$('[data-for="'+a+'"]').first()),o.length>0&&o.hide()}},boolDisplay:function(t,e){return e?"True":"False"},selectDisplay:function(t,e){if("[object Array]"===Object.prototype.toString.call(t.options.dataSource))for(var i=0;i<t.options.dataSource.length;++i)if("object"==typeof t.options.dataSource[i])if("[object Array]"===Object.prototype.toString.call(t.options.dataSource[i])){if(t.options.dataSource[i].length>=2&&t.options.dataSource[i][0]==e){e=t.options.dataSource[i][1];break}}else if(t.options.dataSource[i].value==e){e=t.options.dataSource[i].text;break}return e},textareaDisplay:function(t,e){var i=new RegExp("(\r|\n|\r\n)","g");return e.replace(i,"<br/>")},dateDisplay:function(t,e){var i=t.$input.data("DateTimePicker").date();return null!==i?i.format(t.$input.data("DateTimePicker").format()):""}},$.betterEditableData.validators={required:{errorMsg:function(t,e,i){return t+" is required!"},validator:function(t,e,i){return"false"===e||e===!1?!0:"undefined"==typeof t||null==t||""===t?!1:!0}},minlen:{errorMsg:function(t,e,i){return t+" must be atleast "+e+" characters long!"},validator:function(t,e,i){return t.length>0&&t.length<Number(e)?!1:!0}},maxlen:{errorMsg:function(t,e,i){return t+" must not be longer then "+e+" characters!"},validator:function(t,e,i){return t.length>Number(e)?!1:!0}},length:{errorMsg:function(t,e,i){return t+" must be exactly "+e+" characters long!"},validator:function(t,e,i){return t.length>0&&t.length!=Number(e)?!1:!0}},email:{errorMsg:function(t,e,i){return t+" is not a valid email input!"},validator:function(t,e,i){return"undefined"!=typeof t&&null!==t&&""!==t||"false"!==e&&e!==!1?0==t.length||/^.+?@.+?\..+?$/.test(t):!0}},phone:{errorMsg:function(t,e,i){return t+" is not a valid phone number!"},validator:function(t,e,i){return"undefined"!=typeof t&&null!==t&&""!==t||"false"!==e&&e!==!1?0==t.length||/^[+]{0,1}[0-9]+$/.test(t):!0}},disable:{errorMsg:function(t,e,i){return t+" can't be changed at the moment!"},validator:function(t,e,i){return"false"===e||e===!1?!0:!1}},requiredif:{errorMsg:function(t,e,i){return t+" is required!"},validator:function(t,e,i){var a,n=e;if("undefined"!=typeof i.data("requiredif-dependentpropertyid"))a=RequiredIf(n,i.data("requiredif-dependentpropertyid"));else{for(var o,s=0;"undefined"!=typeof i.data("requiredif-dependentpropertyid-"+s);){if(o=i.data("requiredif-desiredvalue-"+s),("undefined"==typeof o||null===o)&&(o=n),a=RequiredIf(o,i.data("requiredif-dependentpropertyid-"+s)),a&&!$.betterEditableData.validators.required.validator(t,e,i))return!1;++s}a=!1}return a?$.betterEditableData.validators.required.validator(t,e,i):!0}},inputmaskvalidate:{errorMsg:function(t,e,i){return t+" is invalid!"},validator:function(t,e,i){var a=i.betterEditable().$input;return"undefined"==typeof a||"undefined"==typeof t||null===t||""===t?!0:a.inputmask("isComplete")}}},$.betterEditableData.methods={getVersion:function(t){return $.betterEditableData.version},getValue:function(t){return t.getValue()},setValue:function(t,e){t.setValue(e),t.options.displayFunction(t)},submit:function(t){t.setInputValue(),t.initiateSubmit()},setOption:function(t,e,i){return"readOnly"==e?void t.toggleReadOnly(i):(t.options[e]=i,void("tabIndex"==e&&t.options.tabbingOn===!0?t.$element.attr("data-tab-index",t.options.tabIndex):"tabbingOn"!=e||"string"!=typeof t.options.tabIndex&&"number"!=typeof t.options.tabIndex?("submitOnBlur"==e||"clearButton"==e||"buttonsOn"==e||"inputClass"==e||"buttonClass"==e||"type"==e||"mode"==e||"typeSettings"==e||"dataSource"==e)&&("bool"!=t.options.type||"type"==e)&&t.recreateInputField():t.$element.attr("data-tab-index",t.options.tabIndex)))},getOption:function(t,e){return"readOnly"==e?t.state.readOnly:t.options[e]},getOptions:function(t){return t.options},validate:function(t){return t.validate(!1)},toggleEnable:function(t,e){t.toggleReadOnly(!e)},enable:function(t){t.toggleReadOnly(!1)},disable:function(t){t.toggleReadOnly(!0)},focus:function(t){t.isShown()&&t.$input.focus()},destroy:function(t){t.resetState(),t.hideInput(),t.$inputDiv.remove(),delete t},toggle:function(t,e){e===!0?t.isShown()||t.show():t.isShown()&&t.cancel()},show:function(t){t.isShown()||t.show()},hide:function(t){t.isShown()&&t.cancel()},tab:function(t,e){t.isShown()&&t.canTab()&&(-1!==e&&(e=1),t.state.doTab=e,t.initiateSubmit())},createValidator:function(t,e,i,a){if("undefined"!=typeof $.betterEditableData.validators[e])throw"Validator '"+e+"' already exists!";$.betterEditableData.validators[e]={errorMsg:a,validator:i}},attachValidator:function(t,e,i){if("undefined"==typeof $.betterEditableData.validators[e])throw"Validator '"+e+"' does not exist!";for(var a=-1,n=0;n<t.validators.length;++n)if(t.validators[n]==e){a=n;break}-1===a&&t.validators.push(e),"undefined"!=typeof i&&t.$element.data(e,i)},detachValidator:function(t,e){for(var i=0;i<t.validators.length;++i)if(t.validators[i]==e)return void t.validators.splice(i,1)}},$.betterEditableData.submitting=0,$.betterEditableData.blockTab=!1,BetterEditable.prototype.initializeValidators=function(){this.validators=[];var t=this.$element.data();for(var e in t)"undefined"!=typeof $.betterEditableData.validators[e]&&this.validators.push(e)},BetterEditable.prototype.createInputField=function(){var t=this,e=this.options.type;if("number"!=e&&"tel"!=e&&"email"!=e&&"textarea"!=e&&"select"!=e&&"bool"!=e&&"inputmask"!=e&&"datetimepicker"!=e&&"autocomplete"!=e&&(e="text"),this.$inputDiv=$("<div></div>").attr("data-editable-div","").addClass(this.options.mode).addClass(e).addClass("editable-input-div").addClass(this.options.inputClass),this.$input=null,"textarea"==e)this.$input=$("<textarea></textarea>");else if("select"==e){if(this.$input=$("<select></select>"),"[object Array]"===Object.prototype.toString.call(this.options.dataSource))for(var i=0;i<this.options.dataSource.length;++i)"object"==typeof this.options.dataSource[i]&&("[object Array]"===Object.prototype.toString.call(this.options.dataSource[i])?this.options.dataSource[i].length>=2&&this.$input.append($("<option>",{value:this.options.dataSource[i][0],text:this.options.dataSource[i][1]})):this.$input.append($("<option>",{value:this.options.dataSource[i].value,text:this.options.dataSource[i].text})))}else if("bool"==e)this.$input=$("<input></input>").attr("type","hidden");else if("inputmask"==e)this.$input=$("<input></input>").attr("type","text"),this.$input.inputmask(this.options.typeSettings.mask,this.options.typeSettings.settings);else if("datetimepicker"==e)this.$input=$("<input></input>").attr("type","text").attr("onkeydown","return false");else if("autocomplete"==e){this.$input=$("<input></input>").attr("type","text");var a=$.extend({},this.options.typeSettings),n="editable-autocomplete-list editable-autocomplete-"+this.options.mode;"undefined"==typeof a.classes?a.classes={"ui-autocomplete":n}:"[object Object]"===Object.prototype.toString.call(a.classes)&&("undefined"==typeof a.classes["ui-autocomplete"]?a.classes["ui-autocomplete"]=n:"string"==typeof a.classes["ui-autocomplete"]&&(a.classes["ui-autocomplete"]+=" "+n)),this.$input.autocomplete(a)}else this.$input=$("<input></input>").attr("type",e);var o=$("<div></div>").addClass("editable-input-wrapper");if("bool"!=this.options.type&&this.options.submitOnBlur!==!1&&($(document).on("click",function(e,i,a){if("undefined"!=typeof e.originalEvent&&(e=e.originalEvent),t.options.submitOnBlur===!0&&t.state.readOnly===!1&&t.isShown()){if("autocomplete"==t.options.type)if("undefined"!=typeof e.path){for(var n=0;n<e.path.length;++n)if($(e.path[n]).hasClass("ui-autocomplete"))return}else for(var o in e.target.parentNode)if(e.target.parentNode.hasOwnProperty(o)){var s=e.target.parentNode[o];for(var r in s)if(s.hasOwnProperty(r)&&"uiAutocompleteItem"==r)return}t.initiateSubmit()}}),this.$inputDiv.on("click",function(e){t.options.submitOnBlur===!0&&t.state.readOnly===!1&&t.isShown()&&$.betterEditableData.utils.stopPropagation(e)})),"bool"===this.options.type?this.$input.on("click",function(){t.setInputValue(!t.getValue()),t.initiateSubmit()}):this.$input.on("keydown",function(e){27==e.which?($.betterEditableData.utils.preventDefault(e),t.cancel()):13!=e.which||"textarea"==t.options.type&&!e.ctrlKey?t.canTab()&&9==e.which&&($.betterEditableData.utils.preventDefault(e),e.shiftKey?t.state.doTab=-1:t.state.doTab=1,t.initiateSubmit()):($.betterEditableData.utils.preventDefault(e),t.canTab()&&(e.shiftKey?t.state.doTab=-1:t.state.doTab=1),t.initiateSubmit())}),this.$inputDiv.hide(),"popup"==this.options.mode?$("body").append(this.$inputDiv):this.$element.after(this.$inputDiv),this.$inputDiv.append(o),"select"!=e&&"datetimepicker"!=e&&this.options.clearButton===!0&&0===$.betterEditableData.utils.getIEVersion()){var s=$("<span></span>").addClass("editable-clear-button").text("✖");s.on("click",function(){t.$input.val(""),t.$input.focus()}),$clearWrapper=$("<div></div>").addClass("editable-clear-wrapper"),$clearWrapper.append(this.$input),$clearWrapper.append(s),o.append($clearWrapper)}else o.append(this.$input);if("datetimepicker"==e){var r=$.extend({},this.options.typeSettings);"undefined"==typeof r.debug&&(r.debug=!0),"undefined"==typeof r.inline&&(r.inline=!0),this.options.clearButton===!0&&"undefined"==typeof r.showClear&&(r.showClear=!0),this.options.buttonsOn===!1&&"undefined"==typeof r.showClose&&(r.showClose=!0,this.$input.on("dp.hide",function(){t.cancel()})),this.$input.datetimepicker(r),"undefined"==typeof r.useCurrent||r.useCurrent===!0||"undefined"!=typeof r.defaultDate?this.setValue(this.getInputValue()):(this.$input.datetimepicker("clear"),this.setValue(this.getInputValue()))}if(this.options.buttonsOn===!0){var l=$("<div></div>").addClass("editable-button-wrapper"),d=$("<span></span>").addClass("editable-button").addClass(t.options.buttonClass).text("✓");d.on("click",function(){t.initiateSubmit()});var p=$("<span></span>").addClass("editable-button").addClass(t.options.buttonClass).text("✖");p.on("click",function(){t.cancel()}),this.$inputDiv.append(l),l.append(d),l.append(p)}if("popup"==this.options.mode){var u=$("<div></div>").addClass("editable-popup-wrapper").addClass(this.options.placement);this.$inputDiv.wrapInner(u)}},BetterEditable.prototype.recreateInputField=function(){this.isShown()&&this.hideInput(),this.$inputDiv.remove(),this.createInputField(),this.options.displayFunction(this),this.$element.trigger("be.recreateInput",this)},BetterEditable.prototype.canBeShown=function(){return this.state.readOnly===!1&&this.state.popupOpen===!1&&!this.isShown()&&"bool"!==this.options.type},BetterEditable.prototype.isShown=function(){return"bool"==this.options.type||this.$inputDiv.is(":visible")},BetterEditable.prototype.isReadOnly=function(){return this.state.readOnly},BetterEditable.prototype.canTab=function(){return this.options.tabbingOn===!0&&!this.isReadOnly()&&("string"==typeof this.options.tabIndex||"number"==typeof this.options.tabIndex)},BetterEditable.prototype.show=function(){if(!this.canBeShown())return!1;this.state.isValid&&this.options.errorHandler("",this,!1);var t=function(t){if(t.setInputValue(),t.$inputDiv.show(),"popup"===t.options.mode){t.togglePopupOpen(!0);var e=t.$element.offset().top,i=t.$element.offset().left;if("bottom"===t.options.placement)e+=7;else if("top"===t.options.placement){var a=t.$element.outerHeight();t.$inputDiv.children().first().outerHeight()>a&&(a=t.$inputDiv.children().first().outerHeight()),e-=a+8}else if("right"===t.options.placement)i+=t.$element.outerWidth()+7,e-=6;else if("left"===t.options.placement){var n=t.$element.outerWidth();t.$inputDiv.children().first().outerWidth()>n&&(n=t.$inputDiv.children().first().outerWidth()),i-=n+7,e-=6}t.$inputDiv.css("top",e+"px"),t.$inputDiv.css("left",i+"px")}t.$input.focus(),t.$element.trigger("be.shown",t)};if("popup"!==this.options.mode){var e=this;++$.betterEditableData.submitting,$.when(this.$element.hide()).then(function(){e.$inputDiv.show(),--$.betterEditableData.submitting,t(e)})}else t(this)},BetterEditable.prototype.hideInput=function(){var t=this;$.when(this.$inputDiv.hide()).then(function(){t.$element.show()}),"popup"===this.options.mode&&this.togglePopupOpen(!1),this.$element.trigger("be.hidden",this)},BetterEditable.prototype.initiateSubmit=function(t){if("undefined"!=typeof t&&this.$input.val(t),this.options.submitNoChange===!1&&this.getValue()==this.getInputValue())return this.cancel(),this.state.doTab!==!1&&this.triggerTabbing(this.state.doTab),this.resetState();var e=this.submitProcess();e!==!0&&this.hideInput()},BetterEditable.prototype.cancel=function(){this.options.errorHandler("",this,!1),this.hideInput(),this.$element.trigger("be.cancelled",this)},BetterEditable.prototype.triggerTabbing=function(t,e){if(!this.canTab())return!1;var i=Number(this.options.tabIndex);if("object"==typeof e&&null!==e?i=e.data("tab-index"):(i+=t,e=$('[data-editable][data-tab-index="'+i+'"]')),e.length>0){var a={};this.$element.trigger("be.beforeTab",{direction:t,nextTab:i,editable:this,returnData:a});a.data!==!1&&(e=e.first(),"bool"!==e.betterEditable().options.type?e.betterEditable().show():e.betterEditable().canTab()&&e.betterEditable().triggerTabbing(t))}return!0},BetterEditable.prototype.setValue=function(t){"bool"==this.options.type&&"boolean"!=typeof t&&(t="string"==typeof t&&"true"==t.toLowerCase()?!0:!1);var e=this.getValue();return this.value=t,this.$element.trigger("be.change",{newValue:t,oldValue:e,editable:this}),e},BetterEditable.prototype.getValue=function(){return"bool"==this.options.type&&"boolean"!=typeof this.value&&("string"==typeof this.value&&"true"==this.value.toLowerCase()?this.value=!0:this.value=!1),this.value},BetterEditable.prototype.setInputValue=function(t){if("undefined"==typeof t&&(t=this.getValue(),"datetimepicker"==this.options.type)){var e=this.$input.data("DateTimePicker").date();t=null!==e?e.format(this.$input.data("DateTimePicker").format()):""}this.$input.val(t)},BetterEditable.prototype.getInputValue=function(){var t=this.$input.val();return"bool"==this.options.type?"boolean"!=typeof t&&(t="string"==typeof t&&"true"==t.toLowerCase()?!0:!1):"datetimepicker"==this.options.type&&(t=this.$input.data("DateTimePicker").date(),null!==t&&(t=t._d.toString())),t},BetterEditable.prototype.togglePopupOpen=function(t){t!==!0&&t!==!1&&(t=!this.state.popupOpen),t===!0?this.$element.hasClass("popup-open")||this.$element.addClass("popup-open"):this.$element.removeClass("popup-open"),this.state.popupOpen=t},BetterEditable.prototype.toggleReadOnly=function(t){t!==!0&&t!==!1&&(t=!this.state.readOnly),t===!0?(this.isShown()&&this.cancel(),this.$input.hasClass("disabled")||this.$input.addClass("disabled"),this.$input.attr("disabled",""),this.$element.hasClass("disabled")||this.$element.addClass("disabled"),this.$element.attr("disabled","")):(this.$input.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$element.removeClass("disabled"),this.$element.removeAttr("disabled")),this.state.readOnly=t},BetterEditable.prototype.resetState=function(){this.state.isValid=!0,this.state.doTab=!1},BetterEditable.prototype.submitProcess=function(){this.options.errorHandler("",this,!1);var t=this.validate();return t?t=this.submitData():!0},BetterEditable.prototype.validate=function(t){var e=this.getInputValue();this.isShown()||(e=this.getValue());var i=this,a={};if(this.$element.trigger("be.beforeValidate",{newValue:e,editable:i,returnData:a}),a.data===!1)return!1;e=this.getInputValue(),this.isShown()||(e=this.getValue());for(var n=0;n<this.validators.length;++n){var o=this.$element.data(this.validators[n]+"-val");"undefined"==typeof o&&(o=this.$element.data(this.validators[n]));var s=$.betterEditableData.validators[this.validators[n]].validator(e,o,this.$element);if(s===!1){var r=this.$element.data(this.validators[n]+"-msg");return"string"!=typeof r&&(r=$.betterEditableData.validators[this.validators[n]].errorMsg(this.options.fieldName,o,this.$element)),t!==!1&&this.options.errorHandler(r,this,!0),this.state.isValid=!1,this.$element.trigger("be.failedValidation",{newValue:e,editable:i}),!1}}return!0},BetterEditable.prototype.submitData=function(){var t=this.getInputValue();this.isShown()||(t=this.getValue());var e=this.getValue(),i=this,a={};if(this.$element.trigger("be.beforeSubmit",{newValue:t,editable:i,returnData:a}),a.data===!1)return!0;t=this.getInputValue(),this.isShown()||(t=this.getValue()),this.setValue(t);var n=$.extend({},this.options.ajaxParams);"undefined"==typeof n.value&&(n.value=this.getValue()),"undefined"==typeof n.fieldName&&(n.fieldName=this.options.fieldName),"undefined"==typeof n.pk&&(n.pk=this.options.pk);var o=$.extend({},this.options.ajaxObject);"undefined"==typeof o.url&&(o.url=this.options.url),"undefined"==typeof o.type&&(o.type="POST"),"undefined"==typeof o.data&&(o.data=n),"undefined"==typeof o.beforeSend&&(o.beforeSend=function(){i.options.load.start(i)}),"undefined"==typeof o.success&&(o.success=function(t){i.$element.trigger("be.ajaxSuccess",{data:t,editable:i}),i.options.onAjaxSuccess(t,i),i.state.doTab!==!1&&(--$.betterEditableData.submitting,i.triggerTabbing(i.state.doTab)),i.afterProcess()}),"undefined"==typeof o.error&&(o.error=function(t,a,n,o){i.state.isValid=!1;var s=i.getValue();i.setValue(e),i.$element.trigger("be.ajaxError",{errorObj:t,xhr:a,settings:n,exception:o,errorValue:s,editable:i}),i.options.onAjaxError(t,a,n,o,i),i.state.doTab!==!1&&--$.betterEditableData.submitting,i.afterProcess()}),"string"==typeof o.url&&""!==o.url?(i.state.doTab!==!1&&++$.betterEditableData.submitting,$.ajax(o)):(this.options.displayFunction(this),i.state.doTab!==!1&&i.triggerTabbing(i.state.doTab),this.afterProcess())},BetterEditable.prototype.afterProcess=function(){this.resetState()},$.fn.betterEditable=function(t){if("string"!=typeof t)return"object"!=typeof this.data("betterEditable")&&(("object"!=typeof t||null===t)&&(t={}),t.$element=this,this.data("betterEditable",new BetterEditable(t))),this.data("betterEditable");var e=t;if("object"==typeof this.data("betterEditable")&&"function"==typeof $.betterEditableData.methods[e]){var i=[].slice.call(arguments);return i.shift(),i.unshift(this.data("betterEditable")),$.betterEditableData.methods[e].apply(null,i)}},$.initializeEditables=function(t){$("[data-editable]:not([data-editable-no-init])").each(function(){$(this).betterEditable(t)})},$(document).on("keydown",function(t){9==t.which&&($.betterEditableData.submitting>0&&$.betterEditableData.blockTab===!1?$.betterEditableData.utils.preventDefault(t):0===$.betterEditableData.submitting&&0==$("[data-editable-div]:visible").length&&(!t.shiftKey&&$("[data-editable-first-tab]:visible").length>0&&"object"==typeof $("[data-editable-first-tab]:visible").first().betterEditable()&&null!==$("[data-editable-first-tab]:visible").first().betterEditable()&&1==$("[data-editable-first-tab]:visible").first().betterEditable().options.tabbingOn?($.betterEditableData.utils.preventDefault(t),$("[data-editable-first-tab]:visible").first().betterEditable().triggerTabbing(1,$("[data-editable-first-tab]:visible").first())):t.shiftKey&&$("[data-editable-last-tab]:visible").length>0&&"object"==typeof $("[data-editable-last-tab]:visible").first().betterEditable()&&null!==$("[data-editable-last-tab]:visible").first().betterEditable()&&1==$("[data-editable-last-tab]:visible").first().betterEditable().options.tabbingOn&&($.betterEditableData.utils.preventDefault(t),$("[data-editable-last-tab]:visible").first().betterEditable().triggerTabbing(-1,$("[data-editable-last-tab]:visible").first()))))});